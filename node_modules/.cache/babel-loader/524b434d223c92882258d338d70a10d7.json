{"remainingRequest":"/Users/luzheng/Desktop/react+ts电商平台/vueDataV/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!/Users/luzheng/Desktop/react+ts电商平台/vueDataV/src/views/home/jsm/postprocessing/EffectComposer.js","dependencies":[{"path":"/Users/luzheng/Desktop/react+ts电商平台/vueDataV/src/views/home/jsm/postprocessing/EffectComposer.js","mtime":1614269467800},{"path":"/Users/luzheng/Desktop/react+ts电商平台/vueDataV/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/luzheng/Desktop/react+ts电商平台/vueDataV/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCB7IENsb2NrLCBMaW5lYXJGaWx0ZXIsIE1lc2gsIE9ydGhvZ3JhcGhpY0NhbWVyYSwgUGxhbmVCdWZmZXJHZW9tZXRyeSwgUkdCQUZvcm1hdCwgVmVjdG9yMiwgV2ViR0xSZW5kZXJUYXJnZXQgfSBmcm9tICIuLi8uLi90aHJlZS5tb2R1bGUuanMiOwppbXBvcnQgeyBDb3B5U2hhZGVyIH0gZnJvbSAiLi4vc2hhZGVycy9Db3B5U2hhZGVyLmpzIjsKaW1wb3J0IHsgU2hhZGVyUGFzcyB9IGZyb20gIi4uL3Bvc3Rwcm9jZXNzaW5nL1NoYWRlclBhc3MuanMiOwppbXBvcnQgeyBNYXNrUGFzcyB9IGZyb20gIi4uL3Bvc3Rwcm9jZXNzaW5nL01hc2tQYXNzLmpzIjsKaW1wb3J0IHsgQ2xlYXJNYXNrUGFzcyB9IGZyb20gIi4uL3Bvc3Rwcm9jZXNzaW5nL01hc2tQYXNzLmpzIjsKCnZhciBFZmZlY3RDb21wb3NlciA9IGZ1bmN0aW9uIEVmZmVjdENvbXBvc2VyKHJlbmRlcmVyLCByZW5kZXJUYXJnZXQpIHsKICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7CgogIGlmIChyZW5kZXJUYXJnZXQgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmFtZXRlcnMgPSB7CiAgICAgIG1pbkZpbHRlcjogTGluZWFyRmlsdGVyLAogICAgICBtYWdGaWx0ZXI6IExpbmVhckZpbHRlciwKICAgICAgZm9ybWF0OiBSR0JBRm9ybWF0CiAgICB9OwogICAgdmFyIHNpemUgPSByZW5kZXJlci5nZXRTaXplKG5ldyBWZWN0b3IyKCkpOwogICAgdGhpcy5fcGl4ZWxSYXRpbyA9IHJlbmRlcmVyLmdldFBpeGVsUmF0aW8oKTsKICAgIHRoaXMuX3dpZHRoID0gc2l6ZS53aWR0aDsKICAgIHRoaXMuX2hlaWdodCA9IHNpemUuaGVpZ2h0OwogICAgcmVuZGVyVGFyZ2V0ID0gbmV3IFdlYkdMUmVuZGVyVGFyZ2V0KHRoaXMuX3dpZHRoICogdGhpcy5fcGl4ZWxSYXRpbywgdGhpcy5faGVpZ2h0ICogdGhpcy5fcGl4ZWxSYXRpbywgcGFyYW1ldGVycyk7CiAgICByZW5kZXJUYXJnZXQudGV4dHVyZS5uYW1lID0gJ0VmZmVjdENvbXBvc2VyLnJ0MSc7CiAgfSBlbHNlIHsKICAgIHRoaXMuX3BpeGVsUmF0aW8gPSAxOwogICAgdGhpcy5fd2lkdGggPSByZW5kZXJUYXJnZXQud2lkdGg7CiAgICB0aGlzLl9oZWlnaHQgPSByZW5kZXJUYXJnZXQuaGVpZ2h0OwogIH0KCiAgdGhpcy5yZW5kZXJUYXJnZXQxID0gcmVuZGVyVGFyZ2V0OwogIHRoaXMucmVuZGVyVGFyZ2V0MiA9IHJlbmRlclRhcmdldC5jbG9uZSgpOwogIHRoaXMucmVuZGVyVGFyZ2V0Mi50ZXh0dXJlLm5hbWUgPSAnRWZmZWN0Q29tcG9zZXIucnQyJzsKICB0aGlzLndyaXRlQnVmZmVyID0gdGhpcy5yZW5kZXJUYXJnZXQxOwogIHRoaXMucmVhZEJ1ZmZlciA9IHRoaXMucmVuZGVyVGFyZ2V0MjsKICB0aGlzLnJlbmRlclRvU2NyZWVuID0gdHJ1ZTsKICB0aGlzLnBhc3NlcyA9IFtdOyAvLyBkZXBlbmRlbmNpZXMKCiAgaWYgKENvcHlTaGFkZXIgPT09IHVuZGVmaW5lZCkgewogICAgY29uc29sZS5lcnJvcignVEhSRUUuRWZmZWN0Q29tcG9zZXIgcmVsaWVzIG9uIENvcHlTaGFkZXInKTsKICB9CgogIGlmIChTaGFkZXJQYXNzID09PSB1bmRlZmluZWQpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLkVmZmVjdENvbXBvc2VyIHJlbGllcyBvbiBTaGFkZXJQYXNzJyk7CiAgfQoKICB0aGlzLmNvcHlQYXNzID0gbmV3IFNoYWRlclBhc3MoQ29weVNoYWRlcik7CiAgdGhpcy5jbG9jayA9IG5ldyBDbG9jaygpOwp9OwoKT2JqZWN0LmFzc2lnbihFZmZlY3RDb21wb3Nlci5wcm90b3R5cGUsIHsKICBzd2FwQnVmZmVyczogZnVuY3Rpb24gc3dhcEJ1ZmZlcnMoKSB7CiAgICB2YXIgdG1wID0gdGhpcy5yZWFkQnVmZmVyOwogICAgdGhpcy5yZWFkQnVmZmVyID0gdGhpcy53cml0ZUJ1ZmZlcjsKICAgIHRoaXMud3JpdGVCdWZmZXIgPSB0bXA7CiAgfSwKICBhZGRQYXNzOiBmdW5jdGlvbiBhZGRQYXNzKHBhc3MpIHsKICAgIHRoaXMucGFzc2VzLnB1c2gocGFzcyk7CiAgICBwYXNzLnNldFNpemUodGhpcy5fd2lkdGggKiB0aGlzLl9waXhlbFJhdGlvLCB0aGlzLl9oZWlnaHQgKiB0aGlzLl9waXhlbFJhdGlvKTsKICB9LAogIGluc2VydFBhc3M6IGZ1bmN0aW9uIGluc2VydFBhc3MocGFzcywgaW5kZXgpIHsKICAgIHRoaXMucGFzc2VzLnNwbGljZShpbmRleCwgMCwgcGFzcyk7CiAgICBwYXNzLnNldFNpemUodGhpcy5fd2lkdGggKiB0aGlzLl9waXhlbFJhdGlvLCB0aGlzLl9oZWlnaHQgKiB0aGlzLl9waXhlbFJhdGlvKTsKICB9LAogIHJlbW92ZVBhc3M6IGZ1bmN0aW9uIHJlbW92ZVBhc3MocGFzcykgewogICAgdmFyIGluZGV4ID0gdGhpcy5wYXNzZXMuaW5kZXhPZihwYXNzKTsKCiAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgIHRoaXMucGFzc2VzLnNwbGljZShpbmRleCwgMSk7CiAgICB9CiAgfSwKICBpc0xhc3RFbmFibGVkUGFzczogZnVuY3Rpb24gaXNMYXN0RW5hYmxlZFBhc3MocGFzc0luZGV4KSB7CiAgICBmb3IgKHZhciBpID0gcGFzc0luZGV4ICsgMTsgaSA8IHRoaXMucGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICh0aGlzLnBhc3Nlc1tpXS5lbmFibGVkKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfSwKICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihkZWx0YVRpbWUpIHsKICAgIC8vIGRlbHRhVGltZSB2YWx1ZSBpcyBpbiBzZWNvbmRzCiAgICBpZiAoZGVsdGFUaW1lID09PSB1bmRlZmluZWQpIHsKICAgICAgZGVsdGFUaW1lID0gdGhpcy5jbG9jay5nZXREZWx0YSgpOwogICAgfQoKICAgIHZhciBjdXJyZW50UmVuZGVyVGFyZ2V0ID0gdGhpcy5yZW5kZXJlci5nZXRSZW5kZXJUYXJnZXQoKTsKICAgIHZhciBtYXNrQWN0aXZlID0gZmFsc2U7CiAgICB2YXIgcGFzcywKICAgICAgICBpLAogICAgICAgIGlsID0gdGhpcy5wYXNzZXMubGVuZ3RoOwoKICAgIGZvciAoaSA9IDA7IGkgPCBpbDsgaSsrKSB7CiAgICAgIHBhc3MgPSB0aGlzLnBhc3Nlc1tpXTsKICAgICAgaWYgKHBhc3MuZW5hYmxlZCA9PT0gZmFsc2UpIGNvbnRpbnVlOwogICAgICBwYXNzLnJlbmRlclRvU2NyZWVuID0gdGhpcy5yZW5kZXJUb1NjcmVlbiAmJiB0aGlzLmlzTGFzdEVuYWJsZWRQYXNzKGkpOwogICAgICBwYXNzLnJlbmRlcih0aGlzLnJlbmRlcmVyLCB0aGlzLndyaXRlQnVmZmVyLCB0aGlzLnJlYWRCdWZmZXIsIGRlbHRhVGltZSwgbWFza0FjdGl2ZSk7CgogICAgICBpZiAocGFzcy5uZWVkc1N3YXApIHsKICAgICAgICBpZiAobWFza0FjdGl2ZSkgewogICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLnJlbmRlcmVyLmdldENvbnRleHQoKTsKICAgICAgICAgIHZhciBzdGVuY2lsID0gdGhpcy5yZW5kZXJlci5zdGF0ZS5idWZmZXJzLnN0ZW5jaWw7IC8vY29udGV4dC5zdGVuY2lsRnVuYyggY29udGV4dC5OT1RFUVVBTCwgMSwgMHhmZmZmZmZmZiApOwoKICAgICAgICAgIHN0ZW5jaWwuc2V0RnVuYyhjb250ZXh0Lk5PVEVRVUFMLCAxLCAweGZmZmZmZmZmKTsKICAgICAgICAgIHRoaXMuY29weVBhc3MucmVuZGVyKHRoaXMucmVuZGVyZXIsIHRoaXMud3JpdGVCdWZmZXIsIHRoaXMucmVhZEJ1ZmZlciwgZGVsdGFUaW1lKTsgLy9jb250ZXh0LnN0ZW5jaWxGdW5jKCBjb250ZXh0LkVRVUFMLCAxLCAweGZmZmZmZmZmICk7CgogICAgICAgICAgc3RlbmNpbC5zZXRGdW5jKGNvbnRleHQuRVFVQUwsIDEsIDB4ZmZmZmZmZmYpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zd2FwQnVmZmVycygpOwogICAgICB9CgogICAgICBpZiAoTWFza1Bhc3MgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChwYXNzIGluc3RhbmNlb2YgTWFza1Bhc3MpIHsKICAgICAgICAgIG1hc2tBY3RpdmUgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAocGFzcyBpbnN0YW5jZW9mIENsZWFyTWFza1Bhc3MpIHsKICAgICAgICAgIG1hc2tBY3RpdmUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnJlbmRlcmVyLnNldFJlbmRlclRhcmdldChjdXJyZW50UmVuZGVyVGFyZ2V0KTsKICB9LAogIHJlc2V0OiBmdW5jdGlvbiByZXNldChyZW5kZXJUYXJnZXQpIHsKICAgIGlmIChyZW5kZXJUYXJnZXQgPT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgc2l6ZSA9IHRoaXMucmVuZGVyZXIuZ2V0U2l6ZShuZXcgVmVjdG9yMigpKTsKICAgICAgdGhpcy5fcGl4ZWxSYXRpbyA9IHRoaXMucmVuZGVyZXIuZ2V0UGl4ZWxSYXRpbygpOwogICAgICB0aGlzLl93aWR0aCA9IHNpemUud2lkdGg7CiAgICAgIHRoaXMuX2hlaWdodCA9IHNpemUuaGVpZ2h0OwogICAgICByZW5kZXJUYXJnZXQgPSB0aGlzLnJlbmRlclRhcmdldDEuY2xvbmUoKTsKICAgICAgcmVuZGVyVGFyZ2V0LnNldFNpemUodGhpcy5fd2lkdGggKiB0aGlzLl9waXhlbFJhdGlvLCB0aGlzLl9oZWlnaHQgKiB0aGlzLl9waXhlbFJhdGlvKTsKICAgIH0KCiAgICB0aGlzLnJlbmRlclRhcmdldDEuZGlzcG9zZSgpOwogICAgdGhpcy5yZW5kZXJUYXJnZXQyLmRpc3Bvc2UoKTsKICAgIHRoaXMucmVuZGVyVGFyZ2V0MSA9IHJlbmRlclRhcmdldDsKICAgIHRoaXMucmVuZGVyVGFyZ2V0MiA9IHJlbmRlclRhcmdldC5jbG9uZSgpOwogICAgdGhpcy53cml0ZUJ1ZmZlciA9IHRoaXMucmVuZGVyVGFyZ2V0MTsKICAgIHRoaXMucmVhZEJ1ZmZlciA9IHRoaXMucmVuZGVyVGFyZ2V0MjsKICB9LAogIHNldFNpemU6IGZ1bmN0aW9uIHNldFNpemUod2lkdGgsIGhlaWdodCkgewogICAgdGhpcy5fd2lkdGggPSB3aWR0aDsKICAgIHRoaXMuX2hlaWdodCA9IGhlaWdodDsKICAgIHZhciBlZmZlY3RpdmVXaWR0aCA9IHRoaXMuX3dpZHRoICogdGhpcy5fcGl4ZWxSYXRpbzsKICAgIHZhciBlZmZlY3RpdmVIZWlnaHQgPSB0aGlzLl9oZWlnaHQgKiB0aGlzLl9waXhlbFJhdGlvOwogICAgdGhpcy5yZW5kZXJUYXJnZXQxLnNldFNpemUoZWZmZWN0aXZlV2lkdGgsIGVmZmVjdGl2ZUhlaWdodCk7CiAgICB0aGlzLnJlbmRlclRhcmdldDIuc2V0U2l6ZShlZmZlY3RpdmVXaWR0aCwgZWZmZWN0aXZlSGVpZ2h0KTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHRoaXMucGFzc2VzW2ldLnNldFNpemUoZWZmZWN0aXZlV2lkdGgsIGVmZmVjdGl2ZUhlaWdodCk7CiAgICB9CiAgfSwKICBzZXRQaXhlbFJhdGlvOiBmdW5jdGlvbiBzZXRQaXhlbFJhdGlvKHBpeGVsUmF0aW8pIHsKICAgIHRoaXMuX3BpeGVsUmF0aW8gPSBwaXhlbFJhdGlvOwogICAgdGhpcy5zZXRTaXplKHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHQpOwogIH0KfSk7Cgp2YXIgUGFzcyA9IGZ1bmN0aW9uIFBhc3MoKSB7CiAgLy8gaWYgc2V0IHRvIHRydWUsIHRoZSBwYXNzIGlzIHByb2Nlc3NlZCBieSB0aGUgY29tcG9zZXIKICB0aGlzLmVuYWJsZWQgPSB0cnVlOyAvLyBpZiBzZXQgdG8gdHJ1ZSwgdGhlIHBhc3MgaW5kaWNhdGVzIHRvIHN3YXAgcmVhZCBhbmQgd3JpdGUgYnVmZmVyIGFmdGVyIHJlbmRlcmluZwoKICB0aGlzLm5lZWRzU3dhcCA9IHRydWU7IC8vIGlmIHNldCB0byB0cnVlLCB0aGUgcGFzcyBjbGVhcnMgaXRzIGJ1ZmZlciBiZWZvcmUgcmVuZGVyaW5nCgogIHRoaXMuY2xlYXIgPSBmYWxzZTsgLy8gaWYgc2V0IHRvIHRydWUsIHRoZSByZXN1bHQgb2YgdGhlIHBhc3MgaXMgcmVuZGVyZWQgdG8gc2NyZWVuLiBUaGlzIGlzIHNldCBhdXRvbWF0aWNhbGx5IGJ5IEVmZmVjdENvbXBvc2VyLgoKICB0aGlzLnJlbmRlclRvU2NyZWVuID0gZmFsc2U7Cn07CgpPYmplY3QuYXNzaWduKFBhc3MucHJvdG90eXBlLCB7CiAgc2V0U2l6ZTogZnVuY3Rpb24gc2V0U2l6ZSgpCiAgLyogd2lkdGgsIGhlaWdodCAqLwogIHt9LAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkKICAvKiByZW5kZXJlciwgd3JpdGVCdWZmZXIsIHJlYWRCdWZmZXIsIGRlbHRhVGltZSwgbWFza0FjdGl2ZSAqLwogIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLlBhc3M6IC5yZW5kZXIoKSBtdXN0IGJlIGltcGxlbWVudGVkIGluIGRlcml2ZWQgcGFzcy4nKTsKICB9Cn0pOyAvLyBIZWxwZXIgZm9yIHBhc3NlcyB0aGF0IG5lZWQgdG8gZmlsbCB0aGUgdmlld3BvcnQgd2l0aCBhIHNpbmdsZSBxdWFkLgoKUGFzcy5GdWxsU2NyZWVuUXVhZCA9IGZ1bmN0aW9uICgpIHsKICB2YXIgY2FtZXJhID0gbmV3IE9ydGhvZ3JhcGhpY0NhbWVyYSgtMSwgMSwgMSwgLTEsIDAsIDEpOwogIHZhciBnZW9tZXRyeSA9IG5ldyBQbGFuZUJ1ZmZlckdlb21ldHJ5KDIsIDIpOwoKICB2YXIgRnVsbFNjcmVlblF1YWQgPSBmdW5jdGlvbiBGdWxsU2NyZWVuUXVhZChtYXRlcmlhbCkgewogICAgdGhpcy5fbWVzaCA9IG5ldyBNZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgfTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZ1bGxTY3JlZW5RdWFkLnByb3RvdHlwZSwgJ21hdGVyaWFsJywgewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9tZXNoLm1hdGVyaWFsOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7CiAgICAgIHRoaXMuX21lc2gubWF0ZXJpYWwgPSB2YWx1ZTsKICAgIH0KICB9KTsKICBPYmplY3QuYXNzaWduKEZ1bGxTY3JlZW5RdWFkLnByb3RvdHlwZSwgewogICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgICAgdGhpcy5fbWVzaC5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICB9LAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIocmVuZGVyZXIpIHsKICAgICAgcmVuZGVyZXIucmVuZGVyKHRoaXMuX21lc2gsIGNhbWVyYSk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIEZ1bGxTY3JlZW5RdWFkOwp9KCk7CgpleHBvcnQgeyBFZmZlY3RDb21wb3NlciwgUGFzcyB9Ow=="},{"version":3,"sources":["/Users/luzheng/Desktop/react+ts电商平台/vueDataV/src/views/home/jsm/postprocessing/EffectComposer.js"],"names":["Clock","LinearFilter","Mesh","OrthographicCamera","PlaneBufferGeometry","RGBAFormat","Vector2","WebGLRenderTarget","CopyShader","ShaderPass","MaskPass","ClearMaskPass","EffectComposer","renderer","renderTarget","undefined","parameters","minFilter","magFilter","format","size","getSize","_pixelRatio","getPixelRatio","_width","width","_height","height","texture","name","renderTarget1","renderTarget2","clone","writeBuffer","readBuffer","renderToScreen","passes","console","error","copyPass","clock","Object","assign","prototype","swapBuffers","tmp","addPass","pass","push","setSize","insertPass","index","splice","removePass","indexOf","isLastEnabledPass","passIndex","i","length","enabled","render","deltaTime","getDelta","currentRenderTarget","getRenderTarget","maskActive","il","needsSwap","context","getContext","stencil","state","buffers","setFunc","NOTEQUAL","EQUAL","setRenderTarget","reset","dispose","effectiveWidth","effectiveHeight","setPixelRatio","pixelRatio","Pass","clear","FullScreenQuad","camera","geometry","material","_mesh","defineProperty","get","set","value"],"mappings":"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","sourcesContent":["import {\n\tClock,\n\tLinearFilter,\n\tMesh,\n\tOrthographicCamera,\n\tPlaneBufferGeometry,\n\tRGBAFormat,\n\tVector2,\n\tWebGLRenderTarget\n} from \"../../three.module.js\";\nimport { CopyShader } from \"../shaders/CopyShader.js\";\nimport { ShaderPass } from \"../postprocessing/ShaderPass.js\";\nimport { MaskPass } from \"../postprocessing/MaskPass.js\";\nimport { ClearMaskPass } from \"../postprocessing/MaskPass.js\";\n\nvar EffectComposer = function ( renderer, renderTarget ) {\n\n\tthis.renderer = renderer;\n\n\tif ( renderTarget === undefined ) {\n\n\t\tvar parameters = {\n\t\t\tminFilter: LinearFilter,\n\t\t\tmagFilter: LinearFilter,\n\t\t\tformat: RGBAFormat\n\t\t};\n\n\t\tvar size = renderer.getSize( new Vector2() );\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\t\tthis._width = size.width;\n\t\tthis._height = size.height;\n\n\t\trenderTarget = new WebGLRenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, parameters );\n\t\trenderTarget.texture.name = 'EffectComposer.rt1';\n\n\t} else {\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = renderTarget.width;\n\t\tthis._height = renderTarget.height;\n\n\t}\n\n\tthis.renderTarget1 = renderTarget;\n\tthis.renderTarget2 = renderTarget.clone();\n\tthis.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n\tthis.writeBuffer = this.renderTarget1;\n\tthis.readBuffer = this.renderTarget2;\n\n\tthis.renderToScreen = true;\n\n\tthis.passes = [];\n\n\t// dependencies\n\n\tif ( CopyShader === undefined ) {\n\n\t\tconsole.error( 'THREE.EffectComposer relies on CopyShader' );\n\n\t}\n\n\tif ( ShaderPass === undefined ) {\n\n\t\tconsole.error( 'THREE.EffectComposer relies on ShaderPass' );\n\n\t}\n\n\tthis.copyPass = new ShaderPass( CopyShader );\n\n\tthis.clock = new Clock();\n\n};\n\nObject.assign( EffectComposer.prototype, {\n\n\tswapBuffers: function () {\n\n\t\tvar tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t},\n\n\taddPass: function ( pass ) {\n\n\t\tthis.passes.push( pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t},\n\n\tinsertPass: function ( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t},\n\n\tremovePass: function ( pass ) {\n\n\t\tconst index = this.passes.indexOf( pass );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.passes.splice( index, 1 );\n\n\t\t}\n\n\t},\n\n\tisLastEnabledPass: function ( passIndex ) {\n\n\t\tfor ( var i = passIndex + 1; i < this.passes.length; i ++ ) {\n\n\t\t\tif ( this.passes[ i ].enabled ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\trender: function ( deltaTime ) {\n\n\t\t// deltaTime value is in seconds\n\n\t\tif ( deltaTime === undefined ) {\n\n\t\t\tdeltaTime = this.clock.getDelta();\n\n\t\t}\n\n\t\tvar currentRenderTarget = this.renderer.getRenderTarget();\n\n\t\tvar maskActive = false;\n\n\t\tvar pass, i, il = this.passes.length;\n\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tpass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tvar context = this.renderer.getContext();\n\t\t\t\t\tvar stencil = this.renderer.state.buffers.stencil;\n\n\t\t\t\t\t//context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );\n\n\t\t\t\t\t//context.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.renderer.setRenderTarget( currentRenderTarget );\n\n\t},\n\n\treset: function ( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tvar size = this.renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = this.renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tvar effectiveWidth = this._width * this._pixelRatio;\n\t\tvar effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget1.setSize( effectiveWidth, effectiveHeight );\n\t\tthis.renderTarget2.setSize( effectiveWidth, effectiveHeight );\n\n\t\tfor ( var i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[ i ].setSize( effectiveWidth, effectiveHeight );\n\n\t\t}\n\n\t},\n\n\tsetPixelRatio: function ( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n} );\n\n\nvar Pass = function () {\n\n\t// if set to true, the pass is processed by the composer\n\tthis.enabled = true;\n\n\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\tthis.needsSwap = true;\n\n\t// if set to true, the pass clears its buffer before rendering\n\tthis.clear = false;\n\n\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\tthis.renderToScreen = false;\n\n};\n\nObject.assign( Pass.prototype, {\n\n\tsetSize: function ( /* width, height */ ) {},\n\n\trender: function ( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n} );\n\n// Helper for passes that need to fill the viewport with a single quad.\nPass.FullScreenQuad = ( function () {\n\n\tvar camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tvar geometry = new PlaneBufferGeometry( 2, 2 );\n\n\tvar FullScreenQuad = function ( material ) {\n\n\t\tthis._mesh = new Mesh( geometry, material );\n\n\t};\n\n\tObject.defineProperty( FullScreenQuad.prototype, 'material', {\n\n\t\tget: function () {\n\n\t\t\treturn this._mesh.material;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tthis._mesh.material = value;\n\n\t\t}\n\n\t} );\n\n\tObject.assign( FullScreenQuad.prototype, {\n\n\t\tdispose: function () {\n\n\t\t\tthis._mesh.geometry.dispose();\n\n\t\t},\n\n\t\trender: function ( renderer ) {\n\n\t\t\trenderer.render( this._mesh, camera );\n\n\t\t}\n\n\t} );\n\n\treturn FullScreenQuad;\n\n} )();\n\nexport { EffectComposer, Pass };\n"]}]}